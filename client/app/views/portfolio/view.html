<!-- Public Portfolio View -->
<div class="portfolio-container">
  <!-- Loading State -->
  <div ng-if="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3 text-muted">Loading portfolio...</p>
  </div>

  <!-- Portfolio Not Found -->
  <div ng-if="!loading && !portfolio" class="text-center py-5">
    <div class="container">
      <i class="fas fa-user-slash fa-5x text-muted mb-4"></i>
      <h2 class="text-muted">Portfolio Not Found</h2>
      <p class="text-muted mb-4">The portfolio you're looking for doesn't exist or has been removed.</p>
      <a href="#!/" class="btn btn-primary">Go to Home</a>
    </div>
  </div>

  <!-- Portfolio Content -->
  <div ng-if="!loading && portfolio">
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="container">
        <div class="row align-items-center min-vh-100">
          <div class="col-lg-6">
            <div class="hero-content">
              <h1 class="hero-title">
                Hi, I'm <span class="name-highlight">{{portfolio.user.profile.firstName}} {{portfolio.user.profile.lastName}}</span>
              </h1>
              <h2 class="hero-subtitle text-muted mb-4" ng-if="portfolio.user.profile.title">
                {{portfolio.user.profile.title}}
              </h2>
              <p class="hero-description lead mb-4" ng-if="portfolio.user.profile.bio">
                {{portfolio.user.profile.bio}}
              </p>
              
              <!-- CTA Buttons -->
              <div class="hero-actions mb-4">
                <a href="#projects" class="btn btn-primary btn-lg me-3 scroll-link">
                  <i class="fas fa-folder-open me-2"></i>View My Work
                </a>
                <a href="#contact" class="btn btn-outline-primary btn-lg scroll-link">
                  <i class="fas fa-envelope me-2"></i>Get In Touch
                </a>
              </div>

              <!-- Social Links -->
              <div class="social-links" ng-if="hasSocialLinks()">
                <a href="{{portfolio.user.profile.website}}" target="_blank" rel="noopener" 
                   class="social-link" ng-if="portfolio.user.profile.website" title="Website">
                  <i class="fas fa-globe"></i>
                </a>
                <a href="{{portfolio.user.profile.socialLinks.github}}" target="_blank" rel="noopener" 
                   class="social-link" ng-if="portfolio.user.profile.socialLinks.github" title="GitHub">
                  <i class="fab fa-github"></i>
                </a>
                <a href="{{portfolio.user.profile.socialLinks.linkedin}}" target="_blank" rel="noopener" 
                   class="social-link" ng-if="portfolio.user.profile.socialLinks.linkedin" title="LinkedIn">
                  <i class="fab fa-linkedin"></i>
                </a>
                <a href="{{portfolio.user.profile.socialLinks.twitter}}" target="_blank" rel="noopener" 
                   class="social-link" ng-if="portfolio.user.profile.socialLinks.twitter" title="Twitter">
                  <i class="fab fa-twitter"></i>
                </a>
                <a href="{{portfolio.user.profile.socialLinks.instagram}}" target="_blank" rel="noopener" 
                   class="social-link" ng-if="portfolio.user.profile.socialLinks.instagram" title="Instagram">
                  <i class="fab fa-instagram"></i>
                </a>
                <a href="{{portfolio.user.profile.socialLinks.behance}}" target="_blank" rel="noopener" 
                   class="social-link" ng-if="portfolio.user.profile.socialLinks.behance" title="Behance">
                  <i class="fab fa-behance"></i>
                </a>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="hero-image text-center">
        <img ng-src="{{portfolio.user.profile.profileImage || '/assets/images/default-avatar.png'}}" 
                   class="profile-image rounded-circle shadow-lg"
                   alt="{{portfolio.user.profile.firstName}} {{portfolio.user.profile.lastName}}">
            </div>
          </div>
        </div>
      </div>
      
      <!-- Scroll Indicator -->
      <div class="scroll-indicator">
        <a href="#about" class="scroll-link">
          <i class="fas fa-chevron-down"></i>
        </a>
      </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about-section py-5" ng-if="portfolio.user.profile.skills && portfolio.user.profile.skills.length > 0">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h2 class="section-title text-center mb-5">
              <i class="fas fa-user me-2"></i>About Me
            </h2>
          </div>
        </div>
        
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <!-- Extended Bio -->
            <div class="about-content mb-5" ng-if="portfolio.user.profile.bio">
              <p class="lead text-center">{{portfolio.user.profile.bio}}</p>
            </div>

            <!-- Skills -->
            <div class="skills-section">
              <h4 class="text-center mb-4">Skills & Technologies</h4>
              <div class="skills-grid">
                <span class="skill-tag" ng-repeat="skill in portfolio.user.profile.skills">
                  {{skill}}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

  <!-- Resume Section -->
  <section id="resume" class="resume-section py-5 bg-light" ng-if="resume">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h2 class="section-title text-center mb-5">
              <i class="fas fa-file-pdf me-2"></i>Resume
            </h2>
          </div>
        </div>
        
        <div class="row">
          <div class="col-lg-10 mx-auto" style="margin-bottom: 1rem;">
            <div class="resume-container">
              <div class="resume-actions text-center mb-4">
                <a href="{{resume.originalUrl}}" target="_blank" class="btn btn-primary">
                  <i class="fas fa-download me-2"></i>Download PDF
                </a>
              </div>
              
              <!-- Resume Images -->
              <div class="resume-images" ng-if="resume.images && resume.images.length > 0">
                <div class="resume-page mb-4" ng-repeat="image in resume.images">
                  <img ng-src="{{image}}" 
                       class="img-fluid rounded shadow"
                       alt="Resume page {{$index + 1}}"
                       loading="lazy">
                </div>
              </div>
              
              <!-- Resume Processing -->
              <div ng-if="!resume.images || resume.images.length === 0" class="text-center py-5">
                <div class="spinner-border text-primary mb-3" role="status">
                  <span class="visually-hidden">Processing...</span>
                </div>
                <p class="text-muted">Processing resume for display...</p>
              </div>

              <!-- Inline PDF preview as fallback -->
              <div class="mt-4" ng-if="resume.originalUrl">
                <div class="ratio ratio-16x9">
                  <iframe ng-src="{{getTrustedResumeUrl()}}" title="Resume Preview" allow="fullscreen"></iframe>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Projects Section -->
    <section id="projects" class="projects-section py-5">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h2 class="section-title text-center mb-5">
              <i class="fas fa-folder-open me-2"></i>My Projects
            </h2>
          </div>
        </div>
        <div class="row mb-4">
          <div class="col-md-6 ms-auto">
            <div class="input-group search-bar">
              <span class="input-group-text"><i class="fas fa-search"></i></span>
              <input type="search" class="form-control" placeholder="Search projects..." ng-model="projectQuery">
            </div>
          </div>
        </div>
        
        <!-- Projects Grid -->
        <div class="row" ng-if="portfolio.projects && portfolio.projects.length > 0">
          <div class="col-lg-4 col-md-6 mb-4" ng-repeat="project in portfolio.projects | filter:projectQuery">
            <div class="project-card h-100">
              <div class="project-image">
                <img ng-src="{{project.image || '/assets/images/project-placeholder.jpg'}}" 
                     class="card-img-top"
                     alt="{{project.title}}">
                <div class="project-overlay">
                  <div class="project-actions">
                    <a href="{{project.liveUrl}}" target="_blank" rel="noopener" 
                       class="btn btn-light btn-sm" ng-if="project.liveUrl" title="View Live">
                      <i class="fas fa-external-link-alt"></i>
                    </a>
                    <a href="{{project.githubUrl}}" target="_blank" rel="noopener" 
                       class="btn btn-light btn-sm ms-2" ng-if="project.githubUrl" title="View Code">
                      <i class="fab fa-github"></i>
                    </a>
                  </div>
                </div>
              </div>
              
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{project.title}}</h5>
                <p class="card-text text-muted flex-grow-1">{{project.description}}</p>
                
                <!-- Technologies -->
                <div class="project-technologies mt-auto">
                  <span class="tech-tag" ng-repeat="tech in project.technologies | limitTo:4">
                    {{tech}}
                  </span>
                  <span class="tech-tag more" ng-if="project.technologies.length > 4">
                    +{{project.technologies.length - 4}}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Projects -->
        <div class="row" ng-if="!portfolio.projects || portfolio.projects.length === 0">
          <div class="col-12">
            <div class="text-center py-5">
              <i class="fas fa-folder-open fa-3x text-muted mb-3"></i>
              <p class="text-muted">No projects to display yet.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Blog Section -->
    <section id="blog" class="blog-section py-5 bg-light" ng-if="portfolio.blogs && portfolio.blogs.length > 0">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h2 class="section-title text-center mb-5">
              <i class="fas fa-blog me-2"></i>Latest Blog Posts
            </h2>
          </div>
        </div>
        <div class="row mb-4">
          <div class="col-md-6 ms-auto">
            <div class="input-group search-bar">
              <span class="input-group-text"><i class="fas fa-search"></i></span>
              <input type="search" class="form-control" placeholder="Search blogs..." ng-model="blogQuery">
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-4 col-md-6 mb-4" ng-repeat="blog in (portfolio.blogs | filter:blogQuery) | limitTo:6">
            <div class="blog-card h-100">
              <div class="blog-image">
                <img ng-src="{{blog.featuredImage || '/assets/images/blog-placeholder.jpg'}}" 
                     class="card-img-top"
                     alt="{{blog.title}}">
              </div>
              
              <div class="card-body d-flex flex-column">
                <div class="blog-meta mb-2">
                  <span class="badge bg-primary">{{blog.category}}</span>
                  <small class="text-muted ms-2">{{blog.createdAt | date:'MMM dd, yyyy'}}</small>
                </div>
                
                <h5 class="card-title">{{blog.title}}</h5>
                <p class="card-text text-muted flex-grow-1">{{blog.excerpt}}</p>
                
                <div class="blog-stats mt-auto">
                  <div class="d-flex justify-content-between align-items-center">
                    <div class="stats">
                      <small class="text-muted">
                        <i class="fas fa-eye me-1"></i>{{blog.views || 0}}
                        <i class="fas fa-heart ms-2 me-1"></i>{{blog.likes || 0}}
                      </small>
                    </div>
                    <a href="#!/portfolio/{{portfolio.user.username}}/blog/{{blog.slug}}" class="btn btn-sm btn-outline-primary">
                      Read More
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section py-5">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h2 class="section-title text-center mb-5">
              <i class="fas fa-envelope me-2"></i>Get In Touch
            </h2>
          </div>
        </div>
        
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <div class="contact-info text-center">
              <p class="lead mb-4">
                I'm always interested in new opportunities and collaborations.
              </p>
              
              <div class="contact-methods">
                <div class="row">
                  <div class="col-md-6 mb-4" ng-if="portfolio.user.email">
                    <div class="contact-method">
                      <i class="fas fa-envelope fa-2x text-primary mb-3"></i>
                      <h5>Email</h5>
                      <a href="mailto:{{portfolio.user.email}}" class="text-decoration-none">
                        {{portfolio.user.email}}
                      </a>
                    </div>
                  </div>
                  
                  <div class="col-md-6 mb-4" ng-if="portfolio.user.profile.phone">
                    <div class="contact-method">
                      <i class="fas fa-phone fa-2x text-primary mb-3"></i>
                      <h5>Phone</h5>
                      <a href="tel:{{portfolio.user.profile.phone}}" class="text-decoration-none">
                        {{portfolio.user.profile.phone}}
                      </a>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Location -->
              <div ng-if="portfolio.user.profile.location" class="location-info mt-4">
                <i class="fas fa-map-marker-alt text-primary me-2"></i>
                <span>{{portfolio.user.profile.location}}</span>
              </div>
              
              <!-- Social Links -->
              <div class="social-links mt-4" ng-if="hasSocialLinks()">
                <a href="{{portfolio.user.profile.website}}" target="_blank" rel="noopener" 
                   class="social-link me-3" ng-if="portfolio.user.profile.website" title="Website">
                  <i class="fas fa-globe fa-2x"></i>
                </a>
                <a href="{{portfolio.user.profile.socialLinks.github}}" target="_blank" rel="noopener" 
                   class="social-link me-3" ng-if="portfolio.user.profile.socialLinks.github" title="GitHub">
                  <i class="fab fa-github fa-2x"></i>
                </a>
                <a href="{{portfolio.user.profile.socialLinks.linkedin}}" target="_blank" rel="noopener" 
                   class="social-link me-3" ng-if="portfolio.user.profile.socialLinks.linkedin" title="LinkedIn">
                  <i class="fab fa-linkedin fa-2x"></i>
                </a>
                <a href="{{portfolio.user.profile.socialLinks.twitter}}" target="_blank" rel="noopener" 
                   class="social-link me-3" ng-if="portfolio.user.profile.socialLinks.twitter" title="Twitter">
                  <i class="fab fa-twitter fa-2x"></i>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="portfolio-footer py-4 bg-dark text-white">
      <div class="container">
        <div class="row">
          <div class="col-12 text-center">
            <p class="mb-2">
              &copy; {{currentYear}} {{portfolio.user.profile.firstName}} {{portfolio.user.profile.lastName}}. 
              All rights reserved.
            </p>
            <p class="mb-0 small text-muted">
              Built with Portfolio CMS
            </p>
          </div>
        </div>
      </div>
    </footer>
  </div>
</div>

<!-- Custom Styles -->
<style>
/* Remove default body margins that can cause stray whitespace */
body { margin: 0; }

/* Hero Section */
.hero-section {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  position: relative;
  overflow: hidden;
}

.hero-section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.3);
}

.hero-content {
  position: relative;
  z-index: 2;
}

.hero-title {
  font-size: 3.5rem;
  font-weight: 700;
  margin-bottom: 1rem;
}

.hero-subtitle {
  font-size: 1.5rem;
  font-weight: 300;
}

.profile-image {
  width: 300px;
  height: 300px;
  object-fit: cover;
  border: 8px solid rgba(255, 255, 255, 0.2);
}

.social-links {
  display: flex;
  gap: 1rem;
}

.social-link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 50px;
  height: 50px;
  background-color: rgba(255, 255, 255, 0.1);
  color: white;
  border-radius: 50%;
  text-decoration: none;
  transition: all 0.3s ease;
}

.social-link:hover {
  background-color: rgba(255, 255, 255, 0.2);
  color: white;
  transform: translateY(-3px);
}

.scroll-indicator {
  position: absolute;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  z-index: 2;
}

.scroll-indicator a {
  color: white;
  font-size: 2rem;
  text-decoration: none;
  animation: bounce 2s infinite;
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-10px);
  }
  60% {
    transform: translateY(-5px);
  }
}

/* Section Styles */
.section-title {
  font-size: 2.5rem;
  font-weight: 600;
  color: #333;
}

/* Skills */
.skills-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  justify-content: center;
}

.skill-tag {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 25px;
  font-size: 0.9rem;
  font-weight: 500;
}

/* Resume */
.resume-container {
  max-width: 800px;
  margin: 0 auto;
}

.resume-page img {
  max-width: 100%;
  height: auto;
}

/* Projects */
.project-card {
  background: white;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

.project-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
}

.project-image {
  position: relative;
  overflow: hidden;
  height: 200px;
}

.project-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.project-card:hover .project-image img {
  transform: scale(1.1);
}

.project-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;

.hero-title .name-highlight {
  color: #FDE68A; /* soft yellow highlight for name on purple gradient */
}

.hero-actions .btn,
.hero-actions .btn i { color: #ffffff !important; }
.hero-actions .btn.btn-outline-primary {
  border-color: #ffffff;
}
.hero-actions .btn.btn-outline-primary:hover {
  background: rgba(255,255,255,0.15);
}

/* Section spacing adjustments to reduce excessive gaps */
.about-section,
.resume-section,
.projects-section,
.blog-section,
.contact-section { padding-top: 3rem; padding-bottom: 3rem; }

.resume-section + .projects-section { margin-top: -1rem; }
.projects-section + .blog-section { margin-top: -0.5rem; }
.hero-section + #about { margin-top: -1rem; }
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.project-card:hover .project-overlay {
  opacity: 1;
}

.project-technologies {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.tech-tag {
  background-color: #f8f9fa;
  color: #6c757d;
  padding: 0.25rem 0.5rem;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 500;
}

.tech-tag.more {
  background-color: #e9ecef;
  color: #495057;
}

/* Blog */
.blog-card {
  background: white;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

.blog-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
}

.blog-image {
  height: 200px;
  overflow: hidden;
}

.blog-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Contact */
.contact-method {
  padding: 2rem;
  border-radius: 15px;
  background: white;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

.contact-method:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
}

/* Responsive */
@media (max-width: 768px) {
  .hero-title {
    font-size: 2.5rem;
  }
  
  .hero-subtitle {
    font-size: 1.2rem;
  }
  
  .profile-image {
    width: 200px;
    height: 200px;
  }
  
  .section-title {
    font-size: 2rem;
  }
}

/* Smooth scrolling */
html {
  scroll-behavior: smooth;
}

.scroll-link {
  cursor: pointer;
}
</style>